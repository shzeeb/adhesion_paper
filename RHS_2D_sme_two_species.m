function [dCdt]=RHS_2D_sme_two_species(C,r_a,r_b,p,q,r,rho,nrows,ncols)

%Initialise dA to be zeros
% dAdt=zeros(1,K);
% dBdt=zeros(1,K);

dCdt=zeros(2,nrows,ncols);

C=reshape(C,[],nrows,ncols);

for i=1:nrows
    for j=1:ncols
    if i>=3 && i<=nrows-2 && j>=3 && j<=ncols-2
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];
        

    
    elseif i==2 && j>2 && j<ncols-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];


    elseif i==1 && j>2 && j<ncols-1
        
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))
            ];

        
        
        
%         dCdt(:,i,j)=[
%             r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
%             r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))+...
%             r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))-...
%             r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
%             r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))-...
%             r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))+...
%             (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
%             (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
%             (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
%             (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
%             (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))-...
%             (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))
%             
%             r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
%             r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))+...
%             r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))-...
%             r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
%             r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))-...
%             r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))+...
%             (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
%             (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
%             (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
%             (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
%             (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))-...
%             (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))
%             ];


        


    elseif i==nrows-1 && j>2 && j<ncols-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];

 
        
    elseif i==nrows && j>2 && j<ncols-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)
            ];
        
        
    elseif j==2 && i>2 && i<nrows-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];
        
    elseif j==1 && i>2 && i<nrows-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];

        
    elseif j==ncols-1 && i>2 && i<nrows-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];
        
        
    elseif j==ncols && i>2 && i<nrows-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))
            ];
        
        
    elseif i==2 && j==2
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];
        
        
    elseif i==2 && j==ncols-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];


    elseif i==1 && j==2
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))
            ];
        

    elseif i==1 && j==ncols-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))
            ];
        

    elseif i==2 && j==1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];

        
    elseif i==2 && j==ncols
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))
            ];
        

    elseif i==nrows-1 && j==2
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];


    elseif i==nrows-1 && j==ncols-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];
        
    elseif i==nrows-1 && j==1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(C(1,i+1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(C(2,i+1,j+1))
            ];
        
        
    elseif i==nrows-1 && j==ncols
        
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i+1,j-1))*(1-p)^(C(1,i-1,j))*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i+1,j-1))
            ];

    elseif i==nrows && j==2
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)
            ];

    elseif i==nrows && j==ncols-1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(0)*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)
            ];


    elseif i==1 && j==1
        
        dCdt(:,i)=[
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))
            
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j+1))*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j+1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j+1))*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j+1))
            ];




    elseif i==1 && j==ncols
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i+1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))-...
            r_a/4*C(1,i,j)*(1-C(1,i+1,j)-C(2,i+1,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(2,i+1,j))+...
            (r_a+r_b)/4*rho*C(1,i+1,j)*C(2,i,j)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i+1,j)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))
            
            r_b/4*C(2,i+1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))-...
            r_b/4*C(2,i,j)*(1-C(2,i+1,j)-C(1,i+1,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(1,i+1,j))+...
            (r_b+r_a)/4*rho*C(2,i+1,j)*C(1,i,j)*(1-q)^(C(2,i+2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i+1,j-1))*(1-q)^(0)*(1-r)^(C(1,i+2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i+1,j-1))*(1-r)^(0)*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i+1,j-1))*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i+1,j-1))*(1-p)^(0)*(1-p)^(C(1,i+1,j))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i+1,j))*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i+1,j)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i+2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i+1,j-1))*(1-p)^(0)*(1-r)^(C(2,i+2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i+1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(0)*(1-q)^(C(2,i+1,j))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i+1,j))*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i+1,j-1))*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i+1,j-1))
            ];



    elseif i==nrows && j==1
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))+...
            r_a/4*C(1,i,j+1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            r_a/4*C(1,i,j)*(1-C(1,i,j+1)-C(2,i,j+1))*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j+1))+...
            (r_a+r_b)/4*rho*C(1,i,j+1)*C(2,i,j)*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j+1)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j+1))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))+...
            r_b/4*C(2,i,j+1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j+1))-...
            r_b/4*C(2,i,j)*(1-C(2,i,j+1)-C(1,i,j+1))*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(0)*(1-q)^(C(2,i-1,j+1))*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(0)*(1-r)^(C(1,i-1,j+1))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j+1))+...
            (r_b+r_a)/4*rho*C(2,i,j+1)*C(1,i,j)*(1-q)^(C(2,i,j+2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j+1))*(1-q)^(0)*(1-r)^(C(1,i,j+2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j+1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(0)*(1-p)^(C(1,i,j+1))*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(2,i,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(0)*(1-p)^(C(1,i-1,j+1))*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(0)*(1-r)^(C(2,i-1,j+1))-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j+1)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(0)*(1-q)^(C(2,i,j+1))*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(0)*(1-r)^(C(1,i,j+1))*(1-p)^(C(1,i,j+2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j+1))*(1-p)^(0)*(1-r)^(C(2,i,j+2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j+1))*(1-r)^(0)
            ];


    elseif i==nrows && j==ncols
        
        dCdt(:,i,j)=[
            r_a/4*C(1,i-1,j)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)+...
            r_a/4*C(1,i,j-1)*(1-C(1,i,j)-C(2,i,j))*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i-1,j)-C(2,i-1,j))*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            r_a/4*C(1,i,j)*(1-C(1,i,j-1)-C(2,i,j-1))*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i-1,j)*C(2,i,j)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(0)+...
            (r_a+r_b)/4*rho*C(1,i,j-1)*C(2,i,j)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i-1,j)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)-...
            (r_a+r_b)/4*rho*C(1,i,j)*C(2,i,j-1)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(0)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)
            
            r_b/4*C(2,i-1,j)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)+...
            r_b/4*C(2,i,j-1)*(1-C(2,i,j)-C(1,i,j))*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i-1,j)-C(1,i-1,j))*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(0)-...
            r_b/4*C(2,i,j)*(1-C(2,i,j-1)-C(1,i,j-1))*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i-1,j)*C(1,i,j)*(1-q)^(C(2,i-2,j))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i-2,j))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(0)+...
            (r_b+r_a)/4*rho*C(2,i,j-1)*C(1,i,j)*(1-q)^(C(2,i,j-2))*(1-q)^(C(2,i,j))*(1-q)^(C(2,i-1,j-1))*(1-q)^(0)*(1-r)^(C(1,i,j-2))*(1-r)^(C(1,i,j))*(1-r)^(C(1,i-1,j-1))*(1-r)^(0)*(1-p)^(C(1,i-1,j))*(1-p)^(0)*(1-p)^(C(1,i,j-1))*(1-p)^(0)*(1-r)^(C(2,i-1,j))*(1-r)^(0)*(1-r)^(C(2,i,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i-1,j)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i-2,j))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i-2,j))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)-...
            (r_b+r_a)/4*rho*C(2,i,j)*C(1,i,j-1)*(1-q)^(C(2,i-1,j))*(1-q)^(0)*(1-q)^(C(2,i,j-1))*(1-q)^(0)*(1-r)^(C(1,i-1,j))*(1-r)^(0)*(1-r)^(C(1,i,j-1))*(1-r)^(0)*(1-p)^(C(1,i,j-2))*(1-p)^(C(1,i,j))*(1-p)^(C(1,i-1,j-1))*(1-p)^(0)*(1-r)^(C(2,i,j-2))*(1-r)^(C(2,i,j))*(1-r)^(C(2,i-1,j-1))*(1-r)^(0)
            ];

    end
    end
end

% dAdt=dCdt(1,:)';
% dBdt=dCdt(2,:)';

dCdt=dCdt(:);

% dAdt=dAdt';
% dBdt=dBdt';